#labels Attack-Vector
=Global scope reachable via this from functions not invoked as methods=

==Effect==
Untrusted functions invoked naively by trusted code can steal access to the global scope.


==Background==
EcmaScript 262 section 10.1.5 defines a Global Object which is the source of all references not satisfied by local function variables, properties of an object in an enclosing with block, or exception variables for an enclosing catch block.


==Assumptions==
An untrusted function can be invoked not as a method and not via call or apply without the global scope as the first input.

And

Untrusted functions that reference `this` are not rewritten to abort execution if `this` is the global object.



==Versions==
All



==Example==
{{{
(function () {
   alert('your cookie is ' + this.document.cookie);
 })();

setTimeout(
    function () {
      alert('your cookie is ' + this.document.cookie);
    }, 0);
}}}