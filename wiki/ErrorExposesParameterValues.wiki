#summary The stack property of Error includes parameter values.
#labels Attack-Vector
=Error Exposes Parameter Values=

==Effect==
A function can steal secrets passed to its caller but not directly passed to it.


==Background==
Any value can be thrown, but the {{{Error}}} class is most frequently used, and is the base class for interpreter Errors.

According to section 15.11 of ES 262:
    S15.11 *Error* *Objects*
    
    Instances of Error objects are thrown as exceptions when runtime errors occur. The Error objects may also serve as base objects for user-defined exception classes.

When {{{Error}}}s are converted to a string, the result is implementation-dependent.  Some interpreters (e.g. SpiderMonkey) add members to {{{Error}}} that include stack trace information.  That stack may include not just names, and source files and line numbers, but also parameter values.


==Assumptions==
Secrets are stored in javascript source file names as in {{{foo.js?password=hello}}}
    OR
{{{Error.stack}}} is readable and contains privileged stack frames with actual parameter values.


==Versions==
Works in Firefox.


==Example==
{{{
// President Skroob knows his luggage combination.
function skroob(luggageCombination) {
  // He orders Dark Helmet around but does not give
  // Dark Helmet his luggage combination.
  // Only an idiot would do that.
  darkHelmet();
}

// Dark Helmet can deduce Skroob's luggage combination 
// without ever receiving it as input and without it
// being stored in an object property.
function darkHelmet() {
  var combo = Number((new Error).stack.match(/skroob\((\d+)\)/)[1]);
  alert('Only an idiot would use that combination!: ' + combo);
}

skroob(1234);
}}}