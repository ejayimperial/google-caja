#labels Attack-Vector
=CSS allows execution of unsanitized javascript?=

==Effect==
On older browsers, crafted CSS stylesheets can execute unsanitized javascript in the global scope.



==Background==
CSS includes several mechanisms for changing the surrounding markup and executing expressions.

The {{{content:}}} property allows text to be added around the modified node.

IE also has an extension that allows execution of arbitrary javascript.  The {{{expression}}} property is described at [http://msdn2.microsoft.com/en-us/library/ms537634.aspx]

    Using the power of dynamic properties, it is now possible to declare property values not only as constants, but also as formulas.
    ...
    For scripting, a dynamic property can be any legal JScript or Microsoft Visual Basic Scripting Edition (VBScript) statement.

[http://msdn2.microsoft.com/en-us/library/ms533503.aspx]
    {{{binding}}} allows binding to externally specified scripts

[http://developer.mozilla.org/en/docs/CSS:-moz-binding] &
[http://developer.mozilla.org/en/docs/XBL:XBL_1.0_Reference:Elements#binding]
    {{{-moz-binding}}} allows binding via the XML interface




==Assumptions==
Untrusted code can generate style elements or style attributes or otherwise add arbitrary CSS rules and create DOM elements that trigger those rules.


==Versions==
IE 5, 6.


==Example==
{{{
<div id="oDiv" style="left:expression(alert("hello"), 0)">
Example DIV
</div>
}}}

{{{
<input style='-moz-binding: url("http://www.mozilla.org/xbl/htmlBindings.xml#checkbox");'>
}}}

{{{
<ul>
  <li style="behavior:url(a1.htc) url(a2.htc)">List Item</li>
</ul>
}}}