#summary Performance of cajoled code
#labels Draft

*THIS IS A DRAFT PAGE*

The process of cajoling rewrites your html, javascript and css.  This rewriting can have an effect on the size, execution speed and user perceived latency of javascript programs.  While the cajoler tries to minimize the impact on performance, there are some additional steps a developer can take to further improve the performance of their cajoled code.  

= Size =

The size of cajoled code is affected by the subset of caja that is used, by the format of the output and its encoding.  For example, a program cajoled in _valija mode_ must include code to read and set global variables in the outermost scope of the program.  This increases the size of the result cajoled program.  Cajoled code can be render "pretty" for readability and debugging or "minified" for succinctness and it can be `gzip` encoded for delivery to a browser since almost all browsers support receiving compressed content.

<wiki:gadget url="http://www.thinkfu.com/size.xml" height="600" width="100%" border="0" />

For least network latency, a cajoled program should be rendered "minified" and delivered gzip-encoded.  If the effects of a javascript program are not expected to affect the rest of the page, a developer incurring the cost of reading and setting globals by wrapping their program in a function wrapper:

{{{
(function () {
  ...your program here...
})();
}}}

= Performance =

The runtime performance of cajoled code on the client (for example in a browser) is affected primarily by the subset of caja that is used and by the use of globals.  The semantics of HTML require that variables created and set in one `<script>` block must be accessible to subsequent `<script>` blocks.  To support this legacy behavior, all opeations on global variables result in expensive read and set operations in code cajoled in _valija mode_.

<wiki:gadget url="http://www.thinkfu.com/time.xml?1" height="600" width="100%" border="0" />

For least runtime latency, performance sensitive functions of a javascript program should be authored in _cajita mode_ using the cajita directive as follows:
{{{
function foo() {
  "use cajita";
  ... your performance sensitive code here...
}
}}}